(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{1163:function(e,t,a){"use strict";a.d(t,"a",(function(){return l}));a(94);var r=a(125),n=a.n(r),s=a(5),o=a.n(s),c=a(1129),i=a(1127);function u(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class l extends o.a.PureComponent{render(){return o.a.createElement("div",{id:"back_button",className:"signup-header"},o.a.createElement(i.Link,{onClick:this.props.onClick,to:this.props.url},o.a.createElement(c.a,{id:"generic_icons.back",defaultMessage:"Back Icon"},e=>o.a.createElement("span",{id:"back_button_icon",className:"fa fa-1x fa-angle-left",title:e.toString()})),o.a.createElement(c.a,{id:"web.header.back",defaultMessage:"Back"})))}}u(l,"propTypes",{url:n.a.string,onClick:n.a.func}),u(l,"defaultProps",{url:"/"})},1166:function(e,t,a){"use strict";t.a=a.p+"files/ab8aa80cba445eb0fb75e6611c292567.png"},1304:function(e,t,a){"use strict";a.d(t,"a",(function(){return o}));var r=a(5),n=a.n(r),s=a(1506);function o(){const{formatMessage:e}=Object(s.a)();return n.a.createElement("i",{className:"fa fa-1x fa-angle-left",title:e({id:"generic_icons.logout",defaultMessage:"Logout Icon"})})}},1471:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return c}));var r=a(16),n=a(8);function s(e){return(t,a)=>{const s=Object(n.getCurrentUserId)(a());return t(r.updateUserMfa(s,!0,e))}}function o(){return(e,t)=>{const a=Object(n.getCurrentUserId)(t());return e(r.updateUserMfa(a,!1))}}function c(){return(e,t)=>{const a=Object(n.getCurrentUserId)(t());return e(r.generateMfaSecret(a))}}},2307:function(e,t,a){"use strict";a.r(t);var r=a(264),n=a(13),s=(a(182),a(126),a(33),a(125)),o=a.n(s),c=a(5),i=a.n(c),u=a(1129),l=a(1128),m=a(1144),d=a(1166),p=a(1163),f=a(1304),h=a(7),b=a(8),g=a(1471),E=(a(66),a(12)),y=a(11),v=a(1134),M=a(1155);function N(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class C extends i.a.PureComponent{constructor(e){super(e),N(this,"submit",e=>{e.preventDefault();const t=this.input.current.value.replace(/\s/g,"");t&&0!==t.length?(this.setState({error:null}),this.props.actions.activateMfa(t).then(({error:e})=>{e?"ent.mfa.activate.authenticate.app_error"===e.server_error_id?this.setState({error:E.ob("mfa.setup.badCode","Invalid code. If this issue persists, contact your System Administrator.")}):this.setState({error:e.message}):this.props.history.push("/mfa/confirm")})):this.setState({error:E.ob("mfa.setup.codeError","Please enter the code from Google Authenticator.")})}),this.state={secret:"",qrCode:""},this.input=i.a.createRef()}componentDidMount(){const e=this.props.currentUser;e&&!e.mfa_active?this.props.actions.generateMfaSecret().then(({data:e,error:t})=>{t?this.setState({serverError:t.message}):this.setState({secret:e.secret,qrCode:e.qr_code})}):this.props.history.push("/")}render(){let e,t,a="form-group";return this.state.error&&(e=i.a.createElement("div",{className:"form-group has-error"},i.a.createElement("label",{className:"control-label"},this.state.error)),a+=" has-error"),this.props.enforceMultifactorAuthentication&&(t=i.a.createElement("p",null,i.a.createElement(v.b,{id:"mfa.setup.required",defaultMessage:"**Multi-factor authentication is required on {siteName}.**",values:{siteName:this.props.siteName}}))),i.a.createElement("div",null,i.a.createElement("form",{onSubmit:this.submit,className:a},t,i.a.createElement("p",null,i.a.createElement(v.b,{id:"mfa.setup.step1",defaultMessage:"**Step 1: **On your phone, download Google Authenticator from [iTunes](!https://itunes.apple.com/us/app/google-authenticator/id388497605?mt=8') or [Google Play](!https://play.google.com/store/apps/details?id=com.google.android.apps.authenticator2&hl=en)"})),i.a.createElement("p",null,i.a.createElement(v.b,{id:"mfa.setup.step2",defaultMessage:"**Step 2: **Use Google Authenticator to scan this QR code, or manually type in the secret key"})),i.a.createElement("div",{className:"form-group"},i.a.createElement("div",{className:"col-sm-12"},i.a.createElement("img",{alt:"qr code image",style:O.qrCode,src:"data:image/png;base64,"+this.state.qrCode}))),i.a.createElement("br",null),i.a.createElement("div",{className:"form-group"},i.a.createElement("p",{className:"col-sm-12"},i.a.createElement(u.a,{id:"mfa.setup.secret",defaultMessage:"Secret: {secret}",values:{secret:this.state.secret}}))),i.a.createElement("p",null,i.a.createElement(v.b,{id:"mfa.setup.step3",defaultMessage:"**Step 3: **Enter the code generated by Google Authenticator"})),i.a.createElement("p",null,i.a.createElement(M.a,{ref:this.input,className:"form-control",placeholder:{id:Object(y.b)("mfa.setup.code"),defaultMessage:"MFA Code"},autoFocus:!0})),e,i.a.createElement("button",{type:"submit",className:"btn btn-primary"},i.a.createElement(u.a,{id:"mfa.setup.save",defaultMessage:"Save"}))))}}N(C,"propTypes",{currentUser:o.a.object,siteName:o.a.string,enforceMultifactorAuthentication:o.a.bool.isRequired,actions:o.a.shape({activateMfa:o.a.func.isRequired,generateMfaSecret:o.a.func.isRequired}).isRequired});const O={qrCode:{maxHeight:170}};var k=Object(r.connect)((function(e){const t=Object(n.getConfig)(e),a=t.SiteName,r="true"===t.EnforceMultifactorAuthentication;return{currentUser:Object(b.getCurrentUser)(e),siteName:a,enforceMultifactorAuthentication:r}}),(function(e){return{actions:Object(h.bindActionCreators)({activateMfa:g.a,generateMfaSecret:g.c},e)}}))(C);function j(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}const A=a(0).Z.KeyCodes;class S extends i.a.PureComponent{constructor(...e){super(...e),j(this,"submit",e=>{e.preventDefault(),Object(m.f)()}),j(this,"onKeyPress",e=>{Object(E.cb)(e,A.ENTER)&&this.submit(e)})}componentDidMount(){document.body.addEventListener("keydown",this.onKeyPress)}componentWillUnmount(){document.body.removeEventListener("keydown",this.onKeyPress)}render(){return i.a.createElement("div",null,i.a.createElement("form",{onSubmit:this.submit,onKeyPress:this.onKeyPress,className:"form-group"},i.a.createElement("p",null,i.a.createElement(v.b,{id:"mfa.confirm.complete",defaultMessage:"**Set up complete!**"})),i.a.createElement("p",null,i.a.createElement(u.a,{id:"mfa.confirm.secure",defaultMessage:"Your account is now secure. Next time you sign in, you will be asked to enter a code from the Google Authenticator app on your phone."})),i.a.createElement("button",{type:"submit",className:"btn btn-primary"},i.a.createElement(u.a,{id:"mfa.confirm.okay",defaultMessage:"Okay"}))))}}class P extends i.a.PureComponent{constructor(...e){var t,a,r;super(...e),r=e=>{e.preventDefault(),Object(m.e)("/login")},(a="handleOnClick")in(t=this)?Object.defineProperty(t,a,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[a]=r}componentDidMount(){document.body.classList.add("sticky"),document.getElementById("root").classList.add("container-fluid"),this.props.enableMultifactorAuthentication||this.props.history.push("/")}componentWillUnmount(){document.body.classList.remove("sticky"),document.getElementById("root").classList.remove("container-fluid")}render(){let e;return e=this.props.mfa&&this.props.enforceMultifactorAuthentication?i.a.createElement("div",{className:"signup-header"},i.a.createElement("button",{className:"style--none color--link",onClick:this.handleOnClick},i.a.createElement(f.a,null),i.a.createElement(u.a,{id:"web.header.logout",defaultMessage:"Logout"}))):i.a.createElement(p.a,null),i.a.createElement("div",{className:"inner-wrap"},i.a.createElement("div",{className:"row content"},i.a.createElement("div",null,e,i.a.createElement("div",{className:"col-sm-12"},i.a.createElement("div",{className:"signup-team__container"},i.a.createElement("h3",null,i.a.createElement(u.a,{id:"mfa.setupTitle",defaultMessage:"Multi-factor Authentication Setup"})),i.a.createElement("img",{alt:"signup team logo",className:"signup-team-logo",src:d.a}),i.a.createElement("div",{id:"mfa"},i.a.createElement(l.g,null,i.a.createElement(l.d,{path:"".concat(this.props.match.url,"/setup"),render:e=>i.a.createElement(k,Object.assign({state:this.state,updateParent:this.updateParent},e))}),i.a.createElement(l.d,{path:"".concat(this.props.match.url,"/confirm"),render:e=>i.a.createElement(S,Object.assign({state:this.state,updateParent:this.updateParent},e))}))))))))}}P.propTypes={location:o.a.object.isRequired,children:o.a.node,mfa:o.a.bool.isRequired,enableMultifactorAuthentication:o.a.bool.isRequired,enforceMultifactorAuthentication:o.a.bool.isRequired,match:o.a.shape({url:o.a.string.isRequired}).isRequired};t.default=Object(r.connect)((function(e){const t=Object(n.getLicense)(e),a=Object(n.getConfig)(e);return{mfa:"true"===t.MFA,enableMultifactorAuthentication:"true"===a.EnableMultifactorAuthentication,enforceMultifactorAuthentication:"true"===a.EnforceMultifactorAuthentication}}))(P)}}]);
//# sourceMappingURL=14.884c4438dd5c7cdaf7a3.js.map