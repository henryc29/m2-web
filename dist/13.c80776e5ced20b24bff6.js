(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{1163:function(e,t,a){"use strict";a.d(t,"a",(function(){return m}));a(94);var r=a(125),s=a.n(r),i=a(5),n=a.n(i),o=a(1129),l=a(1127);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class m extends n.a.PureComponent{render(){return n.a.createElement("div",{id:"back_button",className:"signup-header"},n.a.createElement(l.Link,{onClick:this.props.onClick,to:this.props.url},n.a.createElement(o.a,{id:"generic_icons.back",defaultMessage:"Back Icon"},e=>n.a.createElement("span",{id:"back_button_icon",className:"fa fa-1x fa-angle-left",title:e.toString()})),n.a.createElement(o.a,{id:"web.header.back",defaultMessage:"Back"})))}}c(m,"propTypes",{url:s.a.string,onClick:s.a.func}),c(m,"defaultProps",{url:"/"})},1166:function(e,t,a){"use strict";t.a=a.p+"files/ab8aa80cba445eb0fb75e6611c292567.png"},1244:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var r=a(125),s=a.n(r),i=a(5),n=a.n(i),o=a(1129);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class c extends n.a.PureComponent{render(){const{customDescriptionText:e,siteName:t}=this.props;let a=null;return a=e||n.a.createElement(o.a,{id:"web.root.signup_info",defaultMessage:"All team communication in one place, searchable and accessible anywhere"}),n.a.createElement(n.a.Fragment,null,n.a.createElement("h1",{id:"site_name"},t),n.a.createElement("h4",{id:"site_description",className:"color--light"},a))}}l(c,"propTypes",{customDescriptionText:s.a.string,siteName:s.a.string}),l(c,"defaultProps",{siteName:"Mattermost"})},1460:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return i}));a(56);var r=a(16);function s(e,t,a){return s=>n(s(r.login(e,t,a)))}function i(e,t,a){return s=>n(s(r.loginById(e,t,a)))}async function n(e){let t=await e;return t.error&&"api.context.mfa_required.app_error"===t.error.server_error_id&&(t={data:!0}),t}},2314:function(e,t,a){"use strict";a.r(t);var r=a(264),s=a(7),i=a(16),n=a(13),o=a(184),l=a(86),c=a(1460),m=a(12),u=(a(56),a(183),a(82),a(33),a(515),a(125)),d=a.n(u),p=a(5),h=a.n(p),g=a(1129),E=a(1127),f=a(48),_=a(146),v=a(1144),b=a(93),N=a(0),S=a(1166),w=a(1163),k=a(1145),y=a(1244),R=a(1134);function L(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class C extends h.a.PureComponent{constructor(e){super(e),L(this,"setDocumentTitle",e=>{e&&(document.title=e)}),L(this,"getTokenData",(e,t)=>{const a=JSON.parse(t);return{loading:!1,token:e,email:a.email,teamName:a.name}}),L(this,"getInviteInfo",async e=>{const{data:t,error:a}=await this.props.actions.getTeamInviteInfo(e);t?this.setState({loading:!1,noOpenServerError:!1,serverError:"",teamName:t.name}):a&&this.setState({loading:!1,noOpenServerError:!0,serverError:h.a.createElement(g.a,{id:"signup_user_completed.invalid_invite",defaultMessage:"The invite link was invalid.  Please speak with your Administrator to receive an invitation."})})}),L(this,"handleSignupSuccess",(e,t)=>{Object(_.e)("signup","signup_user_02_complete");const a=new URLSearchParams(this.props.location.search).get("redirect_to");this.props.actions.loginById(t.id,e.password,"").then(({error:t})=>{if(t)if("api.user.login.not_verified.app_error"===t.server_error_id){let t="/should_verify_email?email="+encodeURIComponent(e.email);this.state.teamName&&(t+="&teamname="+encodeURIComponent(this.state.teamName)),a&&(t+="&redirect_to="+a),b.a.push(t)}else this.setState({serverError:t.message,isSubmitting:!1});else this.state.token>0&&this.props.actions.setGlobalItem(this.state.token,JSON.stringify({usedBefore:!0})),a?b.a.push(a):v.f()})}),L(this,"isUserValid",()=>{const e=this.emailRef.current.value.trim();if(!e)return this.setState({nameError:"",emailError:h.a.createElement(g.a,{id:"signup_user_completed.required"}),passwordError:"",serverError:""}),!1;if(!Object(f.isEmail)(e))return this.setState({nameError:"",emailError:h.a.createElement(g.a,{id:"signup_user_completed.validEmail"}),passwordError:"",serverError:""}),!1;const t=this.nameRef.current.value.trim().toLowerCase();if(!t)return this.setState({nameError:h.a.createElement(g.a,{id:"signup_user_completed.required"}),emailError:"",passwordError:"",serverError:""}),!1;const a=m.mb(t);if(a){let e;return e=a.id===N.V.RESERVED_NAME?{nameError:h.a.createElement(g.a,{id:"signup_user_completed.reserved"}),emailError:"",passwordError:"",serverError:""}:{nameError:h.a.createElement(g.a,{id:"signup_user_completed.usernameLength",values:{min:N.Z.MIN_USERNAME_LENGTH,max:N.Z.MAX_USERNAME_LENGTH}}),emailError:"",passwordError:"",serverError:""},this.setState(e),!1}const r=this.passwordRef.current.value,{valid:s,error:i}=m.lb(r,this.props.passwordConfig);return!(!s&&i)||(this.setState({nameError:"",emailError:"",passwordError:i,serverError:""}),!1)}),L(this,"handleSubmit",e=>{if(e.preventDefault(),Object(_.e)("signup_email","click_create_account"),!this.state.isSubmitting&&this.isUserValid()){this.setState({nameError:"",emailError:"",passwordError:"",serverError:"",isSubmitting:!0});const e={email:this.emailRef.current.value.trim(),username:this.nameRef.current.value.trim().toLowerCase(),password:this.passwordRef.current.value,allow_marketing:!0},t=new URLSearchParams(this.props.location.search).get("redirect_to");this.props.actions.createUser(e,this.state.token,this.state.inviteId,t).then(t=>{t.error?this.setState({serverError:t.error.message,isSubmitting:!1}):this.handleSignupSuccess(e,t.data)})}}),L(this,"renderEmailSignup",()=>{let e=null,t=h.a.createElement("span",{id:"valid_email",className:"help-block"},h.a.createElement(g.a,{id:"signup_user_completed.emailHelp",defaultMessage:"Valid email required for sign-up"})),a="form-group";this.state.emailError&&(e=h.a.createElement("label",{className:"control-label"},this.state.emailError),t="",a+=" has-error");let r=null,s=h.a.createElement("span",{id:"valid_name",className:"help-block"},h.a.createElement(g.a,{id:"signup_user_completed.userHelp",defaultMessage:"You can use lowercase letters, numbers, periods, dashes, and underscores."})),i="form-group";this.state.nameError&&(r=h.a.createElement("label",{className:"control-label"},this.state.nameError),s="",i+=" has-error");let n=null,o="form-group";this.state.passwordError&&(n=h.a.createElement("label",{className:"control-label"},this.state.passwordError),o+=" has-error");let l=null;this.state.email&&(l=h.a.createElement(R.b,{id:"signup_user_completed.emailIs",defaultMessage:"Your email address is **{email}**. You'll use this address to sign in to {siteName}.",values:{email:this.state.email,siteName:this.props.siteName}}));let c="mt-8";return this.state.email&&(c="hidden"),h.a.createElement("form",null,h.a.createElement("div",{className:"inner__content"},h.a.createElement("div",{className:c},h.a.createElement("h5",{id:"email_label"},h.a.createElement("strong",null,h.a.createElement(g.a,{id:"signup_user_completed.whatis",defaultMessage:"What's your email address?"}))),h.a.createElement("div",{className:a},h.a.createElement("input",{id:"email",type:"email",ref:this.emailRef,className:"form-control",defaultValue:this.state.email,placeholder:"",maxLength:"128",autoFocus:!0,spellCheck:"false",autoCapitalize:"off"}),e,t)),l,h.a.createElement("div",{className:"mt-8"},h.a.createElement("h5",{id:"name_label"},h.a.createElement("strong",null,h.a.createElement(g.a,{id:"signup_user_completed.chooseUser",defaultMessage:"Choose your username"}))),h.a.createElement("div",{className:i},h.a.createElement("input",{id:"name",type:"text",ref:this.nameRef,className:"form-control",placeholder:"",maxLength:N.Z.MAX_USERNAME_LENGTH,spellCheck:"false",autoCapitalize:"off"}),r,s)),h.a.createElement("div",{className:"mt-8"},h.a.createElement("h5",{id:"password_label"},h.a.createElement("strong",null,h.a.createElement(g.a,{id:"signup_user_completed.choosePwd",defaultMessage:"Choose your password"}))),h.a.createElement("div",{className:o},h.a.createElement("input",{id:"password",type:"password",ref:this.passwordRef,className:"form-control",placeholder:"",maxLength:"128",spellCheck:"false"}),n)),h.a.createElement("p",{className:"mt-5"},h.a.createElement("button",{id:"createAccountButton",type:"submit",onClick:this.handleSubmit,className:"btn-primary btn",disabled:this.state.isSubmitting},h.a.createElement(g.a,{id:"signup_user_completed.create",defaultMessage:"Create Account"})))))});const t=new URLSearchParams(this.props.location.search).get("d"),a=new URLSearchParams(this.props.location.search).get("t"),r=new URLSearchParams(this.props.location.search).get("id");this.state={},a&&a.length>0?this.state=this.getTokenData(a,t):r&&r.length>0&&(this.state={loading:!0,inviteId:r}),this.emailRef=h.a.createRef(),this.nameRef=h.a.createRef(),this.passwordRef=h.a.createRef()}componentDidMount(){Object(_.e)("signup","signup_user_01_welcome"),this.setDocumentTitle(this.props.siteName);const{inviteId:e}=this.state;e&&e.length>0&&this.getInviteInfo(e),this.props.hasAccounts||document.body.classList.remove("sticky")}componentDidUpdate(){this.setDocumentTitle(this.props.siteName)}render(){const{customDescriptionText:e,enableSignUpWithEmail:t,location:a,privacyPolicyLink:r,siteName:s,termsOfServiceLink:i,hasAccounts:n}=this.props;let o,l=null;if(this.state.serverError&&(l=h.a.createElement("div",{id:"existingEmailErrorContainer",className:"form-group has-error"},h.a.createElement("label",{className:"control-label"},this.state.serverError))),this.state.loading)return h.a.createElement(k.a,null);if(!t)return null;o=this.renderEmailSignup();let c=null;return!this.state.noOpenServerError&&o&&(c=h.a.createElement("p",{id:"signup_agreement"},h.a.createElement(R.b,{id:"create_team.agreement",defaultMessage:"By proceeding to create your account and use {siteName}, you agree to our [Terms of Service]({TermsOfServiceLink}) and [Privacy Policy]({PrivacyPolicyLink}). If you do not agree, you cannot use {siteName}.",values:{siteName:s,TermsOfServiceLink:"!".concat(i),PrivacyPolicyLink:"!".concat(r)}}))),this.state.noOpenServerError&&(o=null),h.a.createElement("div",null,n&&h.a.createElement(w.a,{onClick:()=>Object(_.e)("signup_email","click_back")}),h.a.createElement("div",{id:"signup_email_section",className:"col-sm-12"},h.a.createElement("div",{className:"signup-team__container padding--less"},h.a.createElement("img",{alt:"signup team logo",className:"signup-team-logo",src:S.a}),h.a.createElement(y.a,{customDescriptionText:e,siteName:s}),h.a.createElement("h4",{id:"create_account",className:"color--light"},h.a.createElement(g.a,{id:"signup_user_completed.lets",defaultMessage:"Let's create your account"})),h.a.createElement("span",{id:"signin_account",className:"color--light"},h.a.createElement(g.a,{id:"signup_user_completed.haveAccount",defaultMessage:"Already have an account?"})," ",h.a.createElement(E.Link,{id:"signin_account_link",to:"/login"+a.search,onClick:()=>Object(_.e)("signup_email","click_signin_account")},h.a.createElement(g.a,{id:"signup_user_completed.signIn",defaultMessage:"Click here to sign in."}))),o,l,c)))}}L(C,"propTypes",{location:d.a.object,enableSignUpWithEmail:d.a.bool.isRequired,siteName:d.a.string,termsOfServiceLink:d.a.string,privacyPolicyLink:d.a.string,customDescriptionText:d.a.string,passwordConfig:d.a.object,hasAccounts:d.a.bool.isRequired,actions:d.a.shape({createUser:d.a.func.isRequired,loginById:d.a.func.isRequired,setGlobalItem:d.a.func.isRequired,getTeamInviteInfo:d.a.func.isRequired}).isRequired});t.default=Object(r.connect)((function(e){const t=Object(n.getConfig)(e),a="true"===t.EnableSignUpWithEmail,r=t.SiteName,s=t.TermsOfServiceLink,i=t.PrivacyPolicyLink,o=t.CustomDescriptionText,l="false"===t.NoAccounts;return{enableSignUpWithEmail:a,siteName:r,termsOfServiceLink:s,privacyPolicyLink:i,customDescriptionText:o,passwordConfig:Object(m.H)(t),hasAccounts:l}}),(function(e){return{actions:Object(s.bindActionCreators)({createUser:i.createUser,loginById:c.b,setGlobalItem:l.e,getTeamInviteInfo:o.getTeamInviteInfo},e)}}))(C)}}]);
//# sourceMappingURL=13.c80776e5ced20b24bff6.js.map