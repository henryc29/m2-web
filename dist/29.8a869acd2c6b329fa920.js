(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{2297:function(e,t,s){"use strict";s.r(t),s.d(t,"default",(function(){return g}));s(182);var a=s(125),n=s.n(a),i=s(5),o=s.n(i),r=s(1129),d=s(283),c=s.n(d),l=s(1192),p=s(1169),f=s(1362);function u(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class g extends o.a.PureComponent{constructor(e){super(e),u(this,"downloadFile",e=>{const t=this.props.fileInfo.link||Object(l.getFileDownloadUrl)(this.props.fileInfo.id);e.preventDefault(),window.location.href=t}),u(this,"renderPDFPage",(e,t)=>{if((this.pdfPagesRendered[e]||!this.state.pdfPagesLoaded[e])&&t.scale===this.props.scale)return;const s=this["pdfCanvasRef-".concat(e)].current.getContext("2d"),a=this.state.pdfPages[e].getViewport(this.props.scale);this["pdfCanvasRef-".concat(e)].current.height=a.height,this["pdfCanvasRef-".concat(e)].current.width=a.width;const n={canvasContext:s,viewport:a};this.state.pdfPages[e].render(n),this.pdfPagesRendered[e]=!0}),u(this,"getPdfDocument",()=>{c.a.getDocument(this.props.fileUrl).then(this.onDocumentLoad).catch(this.onDocumentLoadError)}),u(this,"onDocumentLoad",e=>{const t=e.numPages<=5?e.numPages:5;this.setState({pdf:e,numPages:t});for(let t=1;t<=e.numPages;t++)e.getPage(t).then(this.onPageLoad)}),u(this,"onDocumentLoadError",e=>{console.log("Unable to load PDF preview: "+e),this.setState({loading:!1,success:!1})}),u(this,"onPageLoad",e=>{const t=Object.assign({},this.state.pdfPages);t[e.pageIndex]=e;const s=Object.assign({},this.state.pdfPagesLoaded);s[e.pageIndex]=!0,this.setState({pdfPages:t,pdfPagesLoaded:s}),0===e.pageIndex&&this.setState({success:!0,loading:!1})}),this.pdfPagesRendered={},this.state={pdf:null,pdfPages:{},pdfPagesLoaded:{},numPages:0,loading:!0,success:!1};for(let e=0;e<5;e++)this["pdfCanvasRef-".concat(e)]=o.a.createRef()}componentDidMount(){this.getPdfDocument()}static getDerivedStateFromProps(e,t){return e.fileUrl!==t.prevFileUrl?{pdf:null,pdfPages:{},pdfPagesLoaded:{},numPages:0,loading:!0,success:!1,prevFileUrl:e.fileUrl}:null}componentDidUpdate(e){if(this.props.fileUrl!==e.fileUrl&&(this.getPdfDocument(),this.pdfPagesRendered={}),this.state.success)for(let t=0;t<this.state.numPages;t++)this.renderPDFPage(t,e)}render(){if(this.state.loading)return o.a.createElement("div",{className:"view-image__loading"},o.a.createElement(p.a,null));if(!this.state.success)return o.a.createElement(f.a,{fileInfo:this.props.fileInfo,fileUrl:this.props.fileUrl});const e=[];for(let t=0;t<this.state.numPages;t++)e.push(o.a.createElement("canvas",{ref:this["pdfCanvasRef-".concat(t)],key:"previewpdfcanvas"+t})),t<this.state.numPages-1&&this.state.numPages>1&&e.push(o.a.createElement("div",{key:"previewpdfspacer"+t,className:"pdf-preview-spacer"}));return this.state.pdf.numPages>5&&e.push(o.a.createElement("div",{className:"pdf-max-pages",key:"previewpdfmorepages"},o.a.createElement("button",{className:"btn btn-primary",onClick:this.downloadFile},o.a.createElement("i",{className:"icon icon-download-outline pdf-download-btn-spacer"}),o.a.createElement(r.a,{id:"pdf_preview.max_pages",defaultMessage:"Download to read more pages"})))),o.a.createElement("div",{className:"post-code"},e)}}u(g,"propTypes",{fileInfo:n.a.object.isRequired,fileUrl:n.a.string.isRequired,scale:n.a.number.isRequired})}}]);
//# sourceMappingURL=29.8a869acd2c6b329fa920.js.map