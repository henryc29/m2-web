(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{1163:function(e,t,a){"use strict";a.d(t,"a",(function(){return d}));a(94);var n=a(125),s=a.n(n),i=a(5),r=a.n(i),o=a(1129),l=a(1127);function c(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class d extends r.a.PureComponent{render(){return r.a.createElement("div",{id:"back_button",className:"signup-header"},r.a.createElement(l.Link,{onClick:this.props.onClick,to:this.props.url},r.a.createElement(o.a,{id:"generic_icons.back",defaultMessage:"Back Icon"},e=>r.a.createElement("span",{id:"back_button_icon",className:"fa fa-1x fa-angle-left",title:e.toString()})),r.a.createElement(o.a,{id:"web.header.back",defaultMessage:"Back"})))}}c(d,"propTypes",{url:s.a.string,onClick:s.a.func}),c(d,"defaultProps",{url:"/"})},1166:function(e,t,a){"use strict";t.a=a.p+"files/ab8aa80cba445eb0fb75e6611c292567.png"},1244:function(e,t,a){"use strict";a.d(t,"a",(function(){return c}));var n=a(125),s=a.n(n),i=a(5),r=a.n(i),o=a(1129);function l(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class c extends r.a.PureComponent{render(){const{customDescriptionText:e,siteName:t}=this.props;let a=null;return a=e||r.a.createElement(o.a,{id:"web.root.signup_info",defaultMessage:"All team communication in one place, searchable and accessible anywhere"}),r.a.createElement(r.a.Fragment,null,r.a.createElement("h1",{id:"site_name"},t),r.a.createElement("h4",{id:"site_description",className:"color--light"},a))}}l(c,"propTypes",{customDescriptionText:s.a.string,siteName:s.a.string}),l(c,"defaultProps",{siteName:"Mattermost"})},1300:function(e,t,a){"use strict";a.d(t,"a",(function(){return u}));a(66),a(82);var n=a(125),s=a.n(n),i=a(5),r=a.n(i),o=a(1129),l=a(12),c=a(11),d=a(1173),p=a(1155);function m(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class u extends r.a.PureComponent{constructor(e){super(e),m(this,"handleChange",e=>{e.preventDefault();const t=e.target.value.trim().replace(/\s/g,"");t!==this.state.token&&this.setState({token:t})}),m(this,"handleSubmit",e=>{e.preventDefault();const t={serverError:"",saving:!0};this.setState(t),this.props.submit(this.props.loginId.toLowerCase(),this.props.password,this.state.token)}),this.state={saving:!1,token:"",serverError:""}}render(){let e,t="";return this.state.serverError&&(e=r.a.createElement("label",{className:"control-label"},this.state.serverError),t=" has-error"),r.a.createElement("form",{onSubmit:this.handleSubmit},r.a.createElement("div",{className:"signup__email-container"},r.a.createElement("p",null,r.a.createElement(o.a,{id:"login_mfa.enterToken",defaultMessage:"To complete the sign in process, please enter a token from your smartphone's authenticator"})),r.a.createElement("div",{className:"form-group"+t},e),r.a.createElement("div",{className:"form-group"+t},r.a.createElement(p.a,{type:"text",className:"form-control",name:"token",placeholder:{id:Object(c.b)("login_mfa.token"),defaultMessage:"MFA Token"},spellCheck:"false",autoComplete:"off",autoFocus:!0,onChange:this.handleChange})),r.a.createElement("div",{className:"form-group"},r.a.createElement(d.a,{saving:this.state.saving,disabled:this.state.saving,onClick:this.handleSubmit,defaultMessage:Object(l.ob)("login_mfa.submit","Submit"),savingMessage:Object(l.ob)("login_mfa.submitting","Submitting...")}))))}}m(u,"propTypes",{loginId:s.a.string.isRequired,password:s.a.string.isRequired,submit:s.a.func.isRequired})},1460:function(e,t,a){"use strict";a.d(t,"a",(function(){return s})),a.d(t,"b",(function(){return i}));a(56);var n=a(16);function s(e,t,a){return s=>r(s(n.login(e,t,a)))}function i(e,t,a){return s=>r(s(n.loginById(e,t,a)))}async function r(e){let t=await e;return t.error&&"api.context.mfa_required.app_error"===t.error.server_error_id&&(t={data:!0}),t}},2320:function(e,t,a){"use strict";a.r(t);var n=a(264),s=a(7),i=a(13),r=a(19),o=a(8),l=a(9),c=a(1237),d=a(1460),p=(a(56),a(126),a(66),a(183),a(82),a(33),a(515),a(125)),m=a.n(p),u=a(5),g=a.n(u),h=a(1129),E=a(269),b=a(1127),f=a(17),S=a(1144),N=a(130),v=a(93),I=a(0),_=a(1153),w=a(12),x=a(296),U=a(11),L=a(1166),C=a(1244),O=a(1225),y=a(1156),M=a(1134),k=a(1163),T=a(1145),R=a(1168),P=a(1290),W=a(1201),B=a(1155),D=a(1174),j=a(1300);function q(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}class A extends g.a.PureComponent{constructor(e){super(e),q(this,"configureTitle",()=>{this.state.sessionExpired?document.title=this.props.intl.formatMessage({id:"login.session_expired.title",defaultMessage:"* {siteName} - Session Expired"},{siteName:this.props.siteName}):document.title=this.props.siteName}),q(this,"showSessionExpiredNotificationIfNeeded",()=>{this.state.sessionExpired&&!this.closeSessionExpiredNotification?Object(x.a)({title:this.props.siteName,body:w.ob("login.session_expired.notification","Session Expired: Please sign in to continue receiving notifications."),requireInteraction:!0,silent:!1,onClick:()=>{window.focus(),this.closeSessionExpiredNotification()&&(this.closeSessionExpiredNotification(),this.closeSessionExpiredNotification=null)}}).then(e=>{this.closeSessionExpiredNotification=e}).catch(()=>{}):!this.state.sessionExpired&&this.closeSessionExpiredNotification&&(this.closeSessionExpiredNotification(),this.closeSessionExpiredNotification=null)}),q(this,"preSubmit",e=>{e.preventDefault(),this.onDismissSessionExpired();const{location:t}=this.props,a=t.search.replace(/(extra=password_change)&?/i,"");a!==t.search&&v.a.replace("".concat(t.pathname).concat(a).concat(t.hash));let n=this.state.loginId;this.loginIdInput.current&&(n=this.loginIdInput.current.value,n!==this.state.loginId&&this.setState({loginId:n}));let s=this.state.password;if(this.passwordInput.current&&(s=this.passwordInput.current.value,s!==this.state.password&&this.setState({password:s})),n=n.trim().toLowerCase(),!n){Object(U.b)("login.noEmail"),Object(U.b)("login.noEmailLdapUsername"),Object(U.b)("login.noEmailUsername"),Object(U.b)("login.noEmailUsernameLdapUsername"),Object(U.b)("login.noLdapUsername"),Object(U.b)("login.noUsername"),Object(U.b)("login.noUsernameLdapUsername");let e="login.no";return this.state.emailSigninEnabled&&(e+="Email"),this.state.usernameSigninEnabled&&(e+="Username"),this.state.ldapEnabled&&(e+="LdapUsername"),void this.setState({serverError:g.a.createElement(h.a,{id:e,values:{ldapUsername:this.props.ldapLoginFieldName||w.ob("login.ldapUsernameLower","AD/LDAP username")}})})}s?this.submit(n,s,""):this.setState({serverError:g.a.createElement(h.a,{id:"login.noPassword",defaultMessage:"Please enter your password"})})}),q(this,"submit",(e,t,a)=>{this.setState({serverError:null,loading:!0}),this.props.actions.login(e,t,a).then(async({error:t})=>{if(t)return void("api.user.login.not_verified.app_error"===t.server_error_id?v.a.push("/should_verify_email?&email="+encodeURIComponent(e)):"store.sql_user.get_for_login.app_error"===t.server_error_id||"ent.ldap.do_login.user_not_registered.app_error"===t.server_error_id?this.setState({showMfa:!1,loading:!1,serverError:g.a.createElement(h.a,{id:"login.userNotFound",defaultMessage:"We couldn't find an account matching your login credentials."})}):"api.user.check_user_password.invalid.app_error"===t.server_error_id||"ent.ldap.do_login.invalid_password.app_error"===t.server_error_id?this.setState({showMfa:!1,loading:!1,serverError:g.a.createElement(h.a,{id:"login.invalidPassword",defaultMessage:"Your password is incorrect."})}):this.state.showMfa||"mfa.validate_token.authenticate.app_error"!==t.server_error_id?this.setState({showMfa:!1,serverError:t.message,loading:!1}):this.setState({showMfa:!0}));const a=new URLSearchParams(this.props.location.search),n=a.get("t")||"",s=a.get("id")||"";if(s||n){const{data:e}=await this.props.actions.addUserToTeamFromInvite(n,s);e?this.finishSignin(e):this.finishSignin()}else this.finishSignin()})}),q(this,"finishSignin",e=>{const t=this.props.experimentalPrimaryTeam,a=new URLSearchParams(this.props.location.search).get("redirect_to");w.wb(),N.a.setWasLoggedIn(!0),a&&a.match(/^\/([^/]|$)/)?v.a.push(a):e?v.a.push("/".concat(e.name)):t?v.a.push("/".concat(t)):S.f()}),q(this,"handleLoginIdChange",e=>{this.setState({loginId:e.target.value})}),q(this,"handlePasswordChange",e=>{this.setState({password:e.target.value})}),q(this,"handleBrandImageError",()=>{this.setState({brandImageError:!0})}),q(this,"createCustomLogin",()=>{if(this.props.enableCustomBrand){const e=this.props.customBrandText||"",t=f.Client4.getBrandImageUrl(0),a=this.state.brandImageError?{display:"none"}:{};return g.a.createElement("div",null,g.a.createElement("img",{alt:"brand image",src:t,onError:this.handleBrandImageError,style:a}),g.a.createElement("div",null,g.a.createElement(D.a,{message:e,options:{mentions:!1,imagesMetadata:null}})))}return null}),q(this,"createLoginPlaceholder",()=>{const e=this.state.ldapEnabled,t=this.state.usernameSigninEnabled,a=[];return this.state.emailSigninEnabled&&a.push(w.ob("login.email","Email")),t&&a.push(w.ob("login.username","Username")),e&&(this.props.ldapLoginFieldName?a.push(this.props.ldapLoginFieldName):a.push(w.ob("login.ldapUsername","AD/LDAP Username"))),a.length>=2?a.slice(0,a.length-1).join(", ")+w.ob("login.placeholderOr"," or ")+a[a.length-1]:1===a.length?a[0]:""}),q(this,"checkSignUpEnabled",()=>this.props.enableSignUpWithEmail||this.props.enableSignUpWithGitLab||this.props.enableSignUpWithOffice365||this.props.enableSignUpWithGoogle||this.props.enableSignUpWithOpenId||this.props.enableLdap||this.props.enableSaml),q(this,"onDismissSessionExpired",()=>{N.a.setWasLoggedIn(!1),this.setState({sessionExpired:!1})}),q(this,"createExtraText",()=>{const e=new URLSearchParams(this.props.location.search).get("extra");return this.state.sessionExpired?g.a.createElement("div",{className:"alert alert-warning"},g.a.createElement(W.a,null)," ",g.a.createElement(h.a,{id:"login.session_expired",defaultMessage:"Your session has expired. Please log in again."})," ",g.a.createElement(b.Link,{className:"btn-close",to:"/login",onClick:this.onDismissSessionExpired},g.a.createElement("span",null,"Ã—"))):e===I.Z.GET_TERMS_ERROR?g.a.createElement("div",{className:"alert has-error no-padding"},g.a.createElement("label",{className:"control-label"},g.a.createElement(h.a,{id:"login.get_terms_error",defaultMessage:"Unable to load terms of service. If this issue persists, contact your System Administrator."}))):e===I.Z.TERMS_REJECTED?g.a.createElement("div",{className:"alert alert-warning"},g.a.createElement(W.a,null),g.a.createElement(M.b,{id:"login.terms_rejected",defaultMessage:"You must agree to the terms of service before accessing {siteName}. Please contact your System Administrator for more details.",values:{siteName:this.props.siteName}})):e===I.Z.SIGNIN_CHANGE?g.a.createElement("div",{className:"alert alert-success"},g.a.createElement(P.a,null),g.a.createElement(h.a,{id:"login.changed",defaultMessage:" Sign-in method changed successfully"})):e===I.Z.SIGNIN_VERIFIED?g.a.createElement("div",{className:"alert alert-success"},g.a.createElement(P.a,null),g.a.createElement(h.a,{id:"login.verified",defaultMessage:" Email Verified"})):e===I.Z.PASSWORD_CHANGE?g.a.createElement("div",{id:"passwordUpdatedSuccess",className:"alert alert-success"},g.a.createElement(P.a,null),g.a.createElement(h.a,{id:"login.passwordChanged",defaultMessage:" Password updated successfully"})):e===I.Z.CREATE_LDAP?g.a.createElement("div",{className:"alert alert-grey"},g.a.createElement(h.a,{id:"login.ldapCreate",defaultMessage:" Enter your AD/LDAP username and password to create an account."})):null}),q(this,"createLoginOptions",()=>{const e=[],t=this.state.ldapEnabled,a=this.props.enableSignUpWithGitLab,n=this.props.enableSignUpWithGoogle,s=this.props.enableSignUpWithOffice365,i=this.props.enableSignUpWithOpenId,r=this.state.samlEnabled,o=this.state.usernameSigninEnabled,l=this.state.emailSigninEnabled;if(l||o||t){let t="";this.state.serverError&&(t=" has-error"),e.push(g.a.createElement("form",{key:"loginBoxes",onSubmit:this.preSubmit},g.a.createElement("div",{className:"signup__email-container"},g.a.createElement(y.a,{error:this.state.serverError,margin:!0}),g.a.createElement("div",{className:"form-group"+t},g.a.createElement("input",{id:"loginId",className:"form-control",ref:this.loginIdInput,name:"loginId",value:this.state.loginId,onChange:this.handleLoginIdChange,placeholder:this.createLoginPlaceholder(),spellCheck:"false",autoCapitalize:"off",autoFocus:!0})),g.a.createElement("div",{className:"form-group"+t},g.a.createElement(B.a,{id:"loginPassword",type:"password",className:"form-control",ref:this.passwordInput,name:"password",value:this.state.password,onChange:this.handlePasswordChange,placeholder:{id:Object(U.b)("login.password"),defaultMessage:"Password"},spellCheck:"false"})),g.a.createElement("div",{className:"form-group"},g.a.createElement("button",{id:"loginButton",type:"submit",className:"btn btn-primary"},g.a.createElement(R.a,{id:"login_button_signing",loading:this.state.loading,text:w.ob("login.signInLoading","Signing in...")},g.a.createElement(h.a,{id:"login.signIn",defaultMessage:"Sign in"})))))))}if(this.props.enableOpenServer&&this.checkSignUpEnabled()&&e.push(g.a.createElement("div",{className:"form-group",key:"signup"},g.a.createElement("span",null,g.a.createElement(h.a,{id:"login.noAccount",defaultMessage:"Don't have an account? "}),g.a.createElement(b.Link,{id:"signup",to:"/signup_user_complete"+this.props.location.search,className:"signup-team-login"},g.a.createElement(h.a,{id:"login.create",defaultMessage:"Create one now"}))))),(o||l)&&e.push(g.a.createElement("div",{id:"login_forgot",key:"forgotPassword",className:"form-group"},g.a.createElement(b.Link,{to:"/reset_password"},g.a.createElement(h.a,{id:"login.forgot",defaultMessage:"I forgot my password."})))),(l||o||t)&&(a||n||r||s||i)&&(e.push(g.a.createElement("div",{key:"divider",className:"or__container"},g.a.createElement(h.a,{id:"login.or",defaultMessage:"or"}))),e.push(g.a.createElement("h5",{key:"oauthHeader"},g.a.createElement(h.a,{id:"login.signInWith",defaultMessage:"Sign in with:"})))),a&&e.push(g.a.createElement("a",{id:"GitLabButton",className:"btn btn-custom-login gitlab",key:"gitlab",href:f.Client4.getOAuthRoute()+"/gitlab/login"+this.props.location.search},g.a.createElement("span",null,g.a.createElement("span",{className:"icon"}),g.a.createElement("span",null,g.a.createElement(h.a,{id:"login.gitlab",defaultMessage:"GitLab"}))))),n&&e.push(g.a.createElement("a",{id:"GoogleButton",className:"btn btn-custom-login google",key:"google",href:f.Client4.getOAuthRoute()+"/google/login"+this.props.location.search},g.a.createElement("span",null,g.a.createElement("span",{className:"icon"}),g.a.createElement("span",null,g.a.createElement(h.a,{id:"login.google",defaultMessage:"Google Apps"}))))),s&&e.push(g.a.createElement("a",{id:"Office365Button",className:"btn btn-custom-login office365",key:"office365",href:f.Client4.getOAuthRoute()+"/office365/login"+this.props.location.search},g.a.createElement("span",null,g.a.createElement("span",{className:"icon"}),g.a.createElement("span",null,g.a.createElement(h.a,{id:"login.office365",defaultMessage:"Office 365"}))))),i){const t={};this.props.openidButtonColor&&(t.backgroundColor=this.props.openidButtonColor);let a=g.a.createElement(h.a,{id:"login.openid",defaultMessage:"Open ID"});this.props.openidButtonText&&(a=this.props.openidButtonText),e.push(g.a.createElement("a",{id:"OpenIdButton",className:"btn btn-custom-login openid",style:t,key:"openid",href:f.Client4.getOAuthRoute()+"/openid/login"+this.props.location.search},g.a.createElement("span",null,g.a.createElement("span",null,a))))}return r&&e.push(g.a.createElement("a",{className:"btn btn-custom-login saml",key:"saml",href:f.Client4.getUrl()+"/login/sso/saml"+this.props.location.search},g.a.createElement("span",null,g.a.createElement("span",{className:"icon fa fa-lock fa--margin-top",title:"Saml icon"}),g.a.createElement("span",null,this.props.samlLoginButtonText)))),0===e.length&&e.push(g.a.createElement(y.a,{key:"noMethods",error:g.a.createElement(h.a,{id:"login.noMethods",defaultMessage:"No sign-in methods are enabled. Please contact your System Administrator."}),margin:!0})),g.a.createElement("div",null,this.createExtraText(),e)}),q(this,"hideMfa",()=>{this.setState({showMfa:!1})});let t="";new URLSearchParams(this.props.location.search).get("extra")===I.Z.SIGNIN_VERIFIED&&new URLSearchParams(this.props.location.search).get("email")&&(t=new URLSearchParams(this.props.location.search).get("email")),this.state={ldapEnabled:this.props.isLicensed&&this.props.enableLdap,usernameSigninEnabled:this.props.enableSignInWithUsername,emailSigninEnabled:this.props.enableSignInWithEmail,samlEnabled:this.props.isLicensed&&this.props.enableSaml,loginId:t,password:"",showMfa:!1,loading:!1,sessionExpired:!1,brandImageError:!1},this.loginIdInput=g.a.createRef(),this.passwordInput=g.a.createRef()}componentDidMount(){if(this.configureTitle(),this.props.currentUser)return void S.f();const e=new URLSearchParams(this.props.location.search),t=e.get("extra"),a=e.get("email");t===I.Z.SIGNIN_VERIFIED&&a&&this.passwordInput.current.focus(),N.a.getWasLoggedIn()&&(t===I.Z.SIGNIN_CHANGE?N.a.setWasLoggedIn(!1):(this.setState({sessionExpired:!0}),e.set("extra",I.Z.SESSION_EXPIRED),v.a.replace("".concat(this.props.location.pathname,"?").concat(e)))),this.showSessionExpiredNotificationIfNeeded()}componentDidUpdate(){this.configureTitle(),this.showSessionExpiredNotificationIfNeeded()}componentWillUnmount(){this.closeSessionExpiredNotification&&(this.closeSessionExpiredNotification(),this.closeSessionExpiredNotification=null)}render(){const{customDescriptionText:e,siteName:t,initializing:a}=this.props;if(a)return g.a.createElement(T.a,null);let n,s,i,r;return this.state.showMfa?(n=g.a.createElement(j.a,{loginId:this.state.loginId,password:this.state.password,submit:this.submit}),r=g.a.createElement(k.a,{onClick:this.hideMfa})):(n=this.createLoginOptions(),s=this.createCustomLogin(),s&&(i="branded")),g.a.createElement("div",null,g.a.createElement(O.a,null),r,g.a.createElement("div",{id:"login_section",className:"col-sm-12"},g.a.createElement("div",{className:"signup-team__container "+i},g.a.createElement("div",{className:"signup__markdown"},s),g.a.createElement("img",{alt:"signup team logo",className:"signup-team-logo",src:L.a}),g.a.createElement("div",{className:"signup__content"},g.a.createElement(C.a,{customDescriptionText:e,siteName:t}),n))))}}q(A,"propTypes",{intl:_.a.isRequired,location:m.a.object.isRequired,isLicensed:m.a.bool.isRequired,currentUser:m.a.object,customBrandText:m.a.string,customDescriptionText:m.a.string,enableCustomBrand:m.a.bool.isRequired,enableLdap:m.a.bool.isRequired,enableOpenServer:m.a.bool.isRequired,enableSaml:m.a.bool.isRequired,enableSignInWithEmail:m.a.bool.isRequired,enableSignInWithUsername:m.a.bool.isRequired,enableSignUpWithEmail:m.a.bool.isRequired,enableSignUpWithGitLab:m.a.bool.isRequired,enableSignUpWithGoogle:m.a.bool.isRequired,enableSignUpWithOffice365:m.a.bool.isRequired,enableSignUpWithOpenId:m.a.bool.isRequired,experimentalPrimaryTeam:m.a.string,ldapLoginFieldName:m.a.string,samlLoginButtonText:m.a.string,openidButtonText:m.a.string,openidButtonColor:m.a.string,siteName:m.a.string,initializing:m.a.bool,actions:m.a.shape({login:m.a.func.isRequired,addUserToTeamFromInvite:m.a.func.isRequired}).isRequired});var G=Object(E.c)(A);t.default=Object(n.connect)((function(e){const t=Object(i.getConfig)(e),a="true"===Object(i.getLicense)(e).IsLicensed,n=t.CustomBrandText,s=t.CustomDescriptionText,c="true"===t.EnableCustomBrand,d="true"===t.EnableLdap,p="true"===t.EnableOpenServer,m="true"===t.EnableSaml,u="true"===t.EnableSignInWithEmail,g="true"===t.EnableSignInWithUsername,h="true"===t.EnableSignUpWithEmail,E="true"===t.EnableSignUpWithGitLab,b="true"===t.EnableSignUpWithGoogle,f="true"===t.EnableSignUpWithOffice365,S="true"===t.EnableSignUpWithOpenId,N=t.LdapLoginFieldName,v=t.SamlLoginButtonText,I=t.OpenIdButtonText,_=t.OpenIdButtonColor,w=t.SiteName,x=e.requests.users.logout.status===l.RequestStatus.SUCCESS||!e.storage.initialized;let U=t.ExperimentalPrimaryTeam;if(U){const t=Object(r.getTeamByName)(e,U);if(t){const a=Object(r.getMyTeamMember)(e,t.id);a&&a.team_id||(U=null)}else U=null}return{currentUser:Object(o.getCurrentUser)(e),isLicensed:a,customBrandText:n,customDescriptionText:s,enableCustomBrand:c,enableLdap:d,enableOpenServer:p,enableSaml:m,enableSignInWithEmail:u,enableSignInWithUsername:g,enableSignUpWithEmail:h,enableSignUpWithGitLab:E,enableSignUpWithGoogle:b,enableSignUpWithOffice365:f,enableSignUpWithOpenId:S,experimentalPrimaryTeam:U,ldapLoginFieldName:N,samlLoginButtonText:v,openidButtonText:I,openidButtonColor:_,siteName:w,initializing:x}}),(function(e){return{actions:Object(s.bindActionCreators)({login:d.a,addUserToTeamFromInvite:c.b},e)}}))(G)}}]);
//# sourceMappingURL=11.cf7975c1fde4f6d649fc.js.map